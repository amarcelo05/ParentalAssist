<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Video Lessons Library - ParentalAssist. Browse all lessons organized by topic.">
  <title>Video Lessons Library - ParentalAssist</title>
  <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
  <!-- HEADER & NAVIGATION -->
  <header>
    <div class="container">
      <nav>
        <a href="../index.html" class="logo">ParentalAssist</a>
        <button class="hamburger" id="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </button>
        <ul class="nav-menu" id="navMenu">
          <li><a href="../index.html">Home</a></li>
          <li><a href="lessons.html">Video Lessons</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- PAGE HEADER -->
  <section class="lesson-header">
    <div class="container">
      <h1>Video Lessons Library</h1>
      <p style="font-size: 18px; opacity: 0.95;">Learn practical communication strategies organized by the challenges you face most.</p>
    </div>
  </section>

  <!-- FILTER/SEARCH -->
  <section class="section section-light">
    <div class="container">
      <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem; align-items: center;">
        <h3 style="margin: 0; flex: 1;">All Topics</h3>
        <input 
          type="text" 
          id="searchInput" 
          placeholder="Search lessons..." 
          style="flex: 1; min-width: 200px; padding: 0.75rem; border: 1px solid var(--light-gray); border-radius: 4px;"
        >
      </div>

      <!-- TOPIC TAGS -->
      <div style="margin-bottom: 2rem;">
        <button class="badge badge-primary" data-topic="all" onclick="filterByTopic('all')">All Topics</button>
        <button class="badge badge-primary" data-topic="defusing" onclick="filterByTopic('defusing')">Defusing Arguments</button>
        <button class="badge badge-primary" data-topic="homework" onclick="filterByTopic('homework')">Homework Battles</button>
        <button class="badge badge-primary" data-topic="listening" onclick="filterByTopic('listening')">Active Listening</button>
        <button class="badge badge-primary" data-topic="autonomy" onclick="filterByTopic('autonomy')">Respecting Autonomy</button>
        <button class="badge badge-primary" data-topic="emotions" onclick="filterByTopic('emotions')">Managing Emotions</button>
      </div>

      <!-- LESSONS GRID -->
      <div class="grid grid-3" id="lessonsGrid">
        <!-- Lessons will be loaded by JavaScript -->
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="section section-accent">
    <div class="container container-narrow">
      <div style="text-align: center;">
        <h2>Get Updates on New Lessons</h2>
        <p>Join our email list to be notified when we release new video lessons.</p>
        <form name="lesson-signup" method="POST" data-netlify="true" style="max-width: 400px; margin: 0 auto;">
          <div style="display: flex; gap: 0.5rem;">
            <input 
              type="email" 
              name="email" 
              placeholder="your@email.com" 
              required
              style="flex: 1; padding: 0.75rem; border: 1px solid var(--light-gray); border-radius: 4px;"
            >
            <button type="submit" class="btn btn-primary">Subscribe</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h4>ParentalAssist</h4>
          <p>Communication strategies for parents of high school students.</p>
        </div>

        <div class="footer-section">
          <h4>Quick Links</h4>
          <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="lessons.html">Video Lessons</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </div>

        <div class="footer-section">
          <h4>Popular Topics</h4>
          <ul>
            <li><a href="#" onclick="filterByTopic('defusing')">Defusing Arguments</a></li>
            <li><a href="#" onclick="filterByTopic('homework')">Homework Battles</a></li>
            <li><a href="#" onclick="filterByTopic('listening')">Active Listening</a></li>
            <li><a href="#" onclick="filterByTopic('autonomy')">Respecting Autonomy</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p>&copy; 2026 ParentalAssist. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="../assets/js/main.js"></script>
  <script>
    // Load and display lessons on page load
    document.addEventListener('DOMContentLoaded', function() {
      loadLessons();
    });

    function loadLessons(filter = 'all', searchTerm = '') {
      fetch('../content/data/videos.json')
        .then(response => response.json())
        .then(data => {
          const grid = document.getElementById('lessonsGrid');
          grid.innerHTML = '';

          let lessons = data.lessons;

          if (filter !== 'all') {
            lessons = lessons.filter(lesson => lesson.topics.includes(filter));
          }

          if (searchTerm) {
            const term = searchTerm.toLowerCase();
            lessons = lessons.filter(lesson => 
              lesson.title.toLowerCase().includes(term) ||
              lesson.summary.toLowerCase().includes(term)
            );
          }

          if (lessons.length === 0) {
            grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--medium-gray);">No lessons found. Try a different search or topic.</p>';
            return;
          }

          lessons.forEach(lesson => {
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
              <div class="card-image" style="background: linear-gradient(135deg, ${lesson.gradient.split(',')[0]} 0%, ${lesson.gradient.split(',')[1] || lesson.gradient} 100%);">
              </div>
              <div class="card-header">
                <h3 class="card-title">${lesson.title}</h3>
              </div>
              <p class="card-text">${lesson.summary}</p>
              <div style="margin-top: 1rem; margin-bottom: 1rem;">
                ${lesson.topics.map(topic => `<span class="badge badge-primary" style="margin-right: 0.5rem;">${capitalizeWord(topic)}</span>`).join('')}
              </div>
              <div class="card-meta">
                <span>${lesson.duration}</span>
                <a href="lesson.html?id=${lesson.id}" style="color: var(--primary-blue); font-weight: 600;">Watch â†’</a>
              </div>
            `;
            grid.appendChild(card);
          });
        })
        .catch(error => console.error('Error loading lessons:', error));
    }

    function filterByTopic(topic) {
      const searchInput = document.getElementById('searchInput');
      loadLessons(topic, searchInput.value);
    }

    // Search functionality
    document.getElementById('searchInput').addEventListener('input', function(e) {
      const activeFilter = document.querySelector('[data-topic].active')?.getAttribute('data-topic') || 'all';
      loadLessons(activeFilter, e.target.value);
    });

    function capitalizeWord(word) {
      return word.charAt(0).toUpperCase() + word.slice(1);
    }
  </script>
</body>
</html>
